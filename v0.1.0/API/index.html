<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API reference · FiniteDifferenceMatrices.jl</title><meta name="title" content="API reference · FiniteDifferenceMatrices.jl"/><meta property="og:title" content="API reference · FiniteDifferenceMatrices.jl"/><meta property="twitter:title" content="API reference · FiniteDifferenceMatrices.jl"/><meta name="description" content="Documentation for FiniteDifferenceMatrices.jl."/><meta property="og:description" content="Documentation for FiniteDifferenceMatrices.jl."/><meta property="twitter:description" content="Documentation for FiniteDifferenceMatrices.jl."/><meta property="og:url" content="https://ohno.github.io/FiniteDifferenceMatrices.jl/API/"/><meta property="twitter:url" content="https://ohno.github.io/FiniteDifferenceMatrices.jl/API/"/><link rel="canonical" href="https://ohno.github.io/FiniteDifferenceMatrices.jl/API/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/fig/logo.ico" rel="icon" type="image/x-icon"/><link href="../assets/css/table.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FiniteDifferenceMatrices.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FiniteDifferenceMatrices.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tables/">Tables</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ohno/FiniteDifferenceMatrices.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ohno/FiniteDifferenceMatrices.jl/blob/main/docs/src/API.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-reference"><a class="docs-heading-anchor" href="#API-reference">API reference</a><a id="API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference" title="Permalink"></a></h1><ul><li><a href="#FiniteDifferenceMatrices.Fornberg1988"><code>FiniteDifferenceMatrices.Fornberg1988</code></a></li><li><a href="#FiniteDifferenceMatrices.fdcoefficient-Tuple{}"><code>FiniteDifferenceMatrices.fdcoefficient</code></a></li><li><a href="#FiniteDifferenceMatrices.fdmatrix-Tuple{Int64}"><code>FiniteDifferenceMatrices.fdmatrix</code></a></li><li><a href="#FiniteDifferenceMatrices.fdvalue-Tuple{Any, Any}"><code>FiniteDifferenceMatrices.fdvalue</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteDifferenceMatrices.Fornberg1988" href="#FiniteDifferenceMatrices.Fornberg1988"><code>FiniteDifferenceMatrices.Fornberg1988</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>Fornberg1988[d,n,m]</code></p><p>This is a foolish implementation of the tables of <a href="https://doi.org/10.1090/S0025-5718-1988-0935077-0">B. Fornberg, <em>Math. Comp.</em> <strong>51</strong> 699-706 (1988)</a> and <a href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">Wikipedia</a> by hand. It was coded to test the <code>fdcoefficient()</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; FiniteDifferenceMatrices.Fornberg1988[:c,1,2]
1×3 Matrix{Rational{Int64}}:
 -1//2  0//1  1//2

julia&gt; FiniteDifferenceMatrices.Fornberg1988[:c,2,2]
1×3 Matrix{Rational{Int64}}:
 1//1  -2//1  1//1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ohno/FiniteDifferenceMatrices.jl/blob/6c5184464072a4f5b4141f867d9bc8f71e7870d4/src/FiniteDifferenceMatrices.jl#L13-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteDifferenceMatrices.fdcoefficient-Tuple{}" href="#FiniteDifferenceMatrices.fdcoefficient-Tuple{}"><code>FiniteDifferenceMatrices.fdcoefficient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>fdcoefficient(; n::Int=1, m::Int=2, d=:c, t=Rational{Int})</code></p><p>This function returns a <code>Dict</code> of the finite difference coefficients <span>$c_i$</span> of</p><p class="math-container">\[\frac{\mathrm{d}^n f}{\mathrm{d}x^n}(x) = \frac{1}{\Delta x^n} \sum_{i} c_i f(x+i\Delta x) + O(\Delta x^m).\]</p><p>This implementation is based on <a href="https://discourse.julialang.org/t/generating-finite-difference-stencils/85876/5">a post on discourse</a> by <a href="https://discourse.julialang.org/u/stevengj/summary">@stevengj</a> and this function is tested to return results equivalent to <a href="https://doi.org/10.1090/S0025-5718-1988-0935077-0">B. Fornberg, <em>Math. Comp.</em> <strong>51</strong> 699-706 (1988)</a>.</p><table><tr><th style="text-align: left">Arguments</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>n</code></td><td style="text-align: left">order of derivative <span>$n$</span></td></tr><tr><td style="text-align: left"><code>m</code></td><td style="text-align: left">order of accuracy <span>$m$</span></td></tr><tr><td style="text-align: left"><code>d</code></td><td style="text-align: left">direction, <code>:c</code> central, <code>:f</code> forward, <code>:b</code> backward</td></tr><tr><td style="text-align: left"><code>t</code></td><td style="text-align: left">type of coefficients, e.g.: <code>Rational{Int}</code>, <code>Rational{BigInt}</code>, <code>Rational{Float64}</code></td></tr></table><p><strong>Examples</strong></p><p>The coefficients of the central, <span>$n=1$</span> and <span>$m=2$</span> differences are <span>$c_{-1} = -1/2, c_{0} = 0, c_{1} = 1/2$</span>.</p><p class="math-container">\[\frac{\mathrm{d}f}{\mathrm{d} x}(x) = \frac{f(x+\Delta x) - f(x-\Delta x)}{2\Delta x} + O(\Delta x^{2})\]</p><pre><code class="language-julia-repl hljs">julia&gt; fdcoefficient(n=1, m=2, d=:c)
Dict{Int64, Rational{Int64}} with 3 entries:
  0  =&gt; 0//1
  -1 =&gt; -1//2
  1  =&gt; 1//2</code></pre><p>The coefficients of the central, <span>$n=1$</span> and <span>$m=1$</span> differences are <span>$c_{0} = -1, c_{1} = 1$</span>.</p><p class="math-container">\[\frac{\mathrm{d}f}{\mathrm{d} x}(x) = \frac{f(x+\Delta x) - f(x)}{\Delta x} + O(\Delta x)\]</p><pre><code class="language-julia-repl hljs">julia&gt; fdcoefficient(n=1, m=1, d=:f)
Dict{Int64, Rational{Int64}} with 2 entries:
  0 =&gt; -1//1
  1 =&gt; 1//1</code></pre><p>The coefficients of the central, <span>$n=2$</span> and <span>$m=2$</span> differences are <span>$c_{-1} = 1, c_{0} = -2, c_{1} = 1$</span>.</p><p class="math-container">\[\frac{\mathrm{d}^{2}f}{\mathrm{d} x^{2}}(x) = \frac{f(x+\Delta x) - 2f(x) + f(x-\Delta x)}{\Delta x^{2}} + O(\Delta x^{2})\]</p><pre><code class="language-julia-repl hljs">julia&gt; fdcoefficient(n=2, m=2, d=:c)
Dict{Int64, Rational{Int64}} with 3 entries:
  0  =&gt; -2//1
  -1 =&gt; 1//1
  1  =&gt; 1//1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ohno/FiniteDifferenceMatrices.jl/blob/6c5184464072a4f5b4141f867d9bc8f71e7870d4/src/FiniteDifferenceMatrices.jl#L90-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteDifferenceMatrices.fdmatrix-Tuple{Int64}" href="#FiniteDifferenceMatrices.fdmatrix-Tuple{Int64}"><code>FiniteDifferenceMatrices.fdmatrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>fdmatrix(N::Int; n::Int=1, m::Int=2, d=:c, h=0.1, t=Rational{Int})</code></p><p>This function returns a discrete approximation of a differential operator as a <a href="https://github.com/JuliaSparse/SparseArrays.jl"><code>SparseMatrixCSC</code></a>. The numerical error is not ignored in high orders (<span>$3&lt;n$</span>, <span>$4&lt;m$</span>) and a small grid spacing (<span>$h&lt;10^{-3}$</span>). Please use high precision arithmetic (<code>h=big&quot;0.001&quot;</code> and <code>t=Rational{BigInt}</code>) in that case.</p><table><tr><th style="text-align: left">Arguments</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>n</code></td><td style="text-align: left">order of derivative <span>$n$</span></td></tr><tr><td style="text-align: left"><code>m</code></td><td style="text-align: left">order of accuracy <span>$m$</span></td></tr><tr><td style="text-align: left"><code>d</code></td><td style="text-align: left">direction, <code>:c</code> central, <code>:f</code> forward, <code>:b</code> backward</td></tr><tr><td style="text-align: left"><code>h</code></td><td style="text-align: left">grid spacing <span>$\Delta x$</span></td></tr><tr><td style="text-align: left"><code>t</code></td><td style="text-align: left">type of coefficients, e.g.: <code>Rational{Int}</code>, <code>Rational{BigInt}</code>, <code>Float64</code></td></tr></table><p><strong>Examples</strong></p><p>The central, <span>$n=1$</span> and <span>$m=2$</span> discrete approximation of the differential operator is</p><p class="math-container">\[\frac{\mathrm{d}}{\mathrm{d} x}
\simeq
\frac{1}{2\Delta x}
\left(\begin{array}{ccccccc}
   0 &amp;  1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
  -1 &amp;  0 &amp; 1 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
   0 &amp; -1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp;  0 &amp;  1 &amp; 0 \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp; -1 &amp;  0 &amp; 1 \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp;  0 &amp; -1 &amp; 0
\end{array}\right).\]</p><pre><code class="language-julia-repl hljs">julia&gt; fdmatrix(5, n=1, m=2, d=:c, h=1//1)
5×5 SparseArrays.SparseMatrixCSC{Rational{Int64}, Int64} with 8 stored entries:
   ⋅     1//2    ⋅      ⋅     ⋅  
 -1//2    ⋅     1//2    ⋅     ⋅  
   ⋅    -1//2    ⋅     1//2   ⋅  
   ⋅      ⋅    -1//2    ⋅    1//2
   ⋅      ⋅      ⋅    -1//2   ⋅  </code></pre><p>The central, <span>$n=1$</span> and <span>$m=1$</span> discrete approximation of the differential operator is</p><p class="math-container">\[\frac{\mathrm{d}}{\mathrm{d} x}
\simeq
\frac{1}{\Delta x}
\left(\begin{array}{ccccccc}
  -1 &amp;  1 &amp;  0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
   0 &amp; -1 &amp;  1 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
   0 &amp;  0 &amp; -1 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp; -1 &amp;  1 &amp;  0 \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp;  0 &amp; -1 &amp;  1 \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp;  0 &amp;  0 &amp; -1
\end{array}\right).\]</p><pre><code class="language-julia-repl hljs">julia&gt; fdmatrix(5, n=1, m=1, d=:f, h=1//1)
5×5 SparseArrays.SparseMatrixCSC{Rational{Int64}, Int64} with 9 stored entries:
 -1//1   1//1    ⋅      ⋅      ⋅  
   ⋅    -1//1   1//1    ⋅      ⋅  
   ⋅      ⋅    -1//1   1//1    ⋅  
   ⋅      ⋅      ⋅    -1//1   1//1
   ⋅      ⋅      ⋅      ⋅    -1//1</code></pre><p>The central, <span>$n=2$</span> and <span>$m=2$</span> discrete approximation of the differential operator is</p><p class="math-container">\[\frac{\mathrm{d}^2}{\mathrm{d} x^2}
\simeq
\frac{1}{\Delta x^2}
\left(\begin{array}{ccccccc}
  -2 &amp;  1 &amp;  0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
   1 &amp; -2 &amp;  1 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
   0 &amp;  1 &amp; -2 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp; -2 &amp;  1 &amp;  0 \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp;  1 &amp; -2 &amp;  1 \\
  0 &amp; 0 &amp; 0 &amp; \ldots &amp;  0 &amp;  1 &amp; -2
\end{array}\right).\]</p><pre><code class="language-julia-repl hljs">julia&gt; fdmatrix(5, n=2, m=2, d=:c, h=1//1)
5×5 SparseArrays.SparseMatrixCSC{Rational{Int64}, Int64} with 13 stored entries:
 -2//1   1//1    ⋅      ⋅      ⋅  
  1//1  -2//1   1//1    ⋅      ⋅  
   ⋅     1//1  -2//1   1//1    ⋅  
   ⋅      ⋅     1//1  -2//1   1//1
   ⋅      ⋅      ⋅     1//1  -2//1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ohno/FiniteDifferenceMatrices.jl/blob/6c5184464072a4f5b4141f867d9bc8f71e7870d4/src/FiniteDifferenceMatrices.jl#L211-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteDifferenceMatrices.fdvalue-Tuple{Any, Any}" href="#FiniteDifferenceMatrices.fdvalue-Tuple{Any, Any}"><code>FiniteDifferenceMatrices.fdvalue</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>fdvalue(f, a; n::Int=1, m::Int=2, d=:c, h=0.1, t=Rational{Int})</code></p><p>This function calculates the differential coefficient <span>$f^{(n)}(a)$</span>, a value of the derivative function <span>$f^{(n)}=\frac{\mathrm{d}^n f}{\mathrm{d}x^n}$</span> at the point <span>$a$</span>.</p><p class="math-container">\[\frac{\mathrm{d}^n f}{\mathrm{d}x^n} (a) = \frac{1}{h^n} \sum_{i} c_i f(a+ih) + O(\Delta x^m).\]</p><p>The numerical error is not ignored in high orders (<span>$3&lt;n$</span>, <span>$4&lt;m$</span>) and a small grid spacing (<span>$h&lt;10^{-3}$</span>). Please use high precision arithmetic (<code>h=big&quot;0.001&quot;</code> and <code>t=Rational{BigInt}</code>) in that case.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fdvalue(x -&gt; x^2, 1.0)
2.0000000000000004

julia&gt; (x -&gt; 2*x)(1.0)
2.0

julia&gt; fdvalue(sin, 0.0)
0.9983341664682815

julia&gt; fdvalue(sin, 0.0, m=4)
0.9999966706326067

julia&gt; fdvalue(sin, 0.0, m=6)
0.9999999928710186

julia&gt; cos(0.0)
1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ohno/FiniteDifferenceMatrices.jl/blob/6c5184464072a4f5b4141f867d9bc8f71e7870d4/src/FiniteDifferenceMatrices.jl#L173-L205">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Tuesday 3 September 2024 11:27">Tuesday 3 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
